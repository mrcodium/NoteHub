.ProseMirror {
  white-space: pre-wrap;
}

.ProseMirror code {
  tab-size: 4;
  -moz-tab-size: 4;
}

.tiptap .pre-wrapper {
  @apply rounded-2xl overflow-hidden my-4;
}

.tiptap .node-codeBlock {
  @apply my-4;
}

div:has(> .tiptap.ProseMirror) {
  flex: 1;
  overflow-y: auto;
}

.tiptap.ProseMirror {
  @apply max-w-screen-md;
}

.ProseMirror input[type="checkbox"] {
  cursor: pointer;
}

.tiptap {
  tab-size: 4;
  @apply p-5;
}

.tiptap .code-block {
  @apply relative;
}

.tiptap .pre-header,
.tiptap .code-block header {
  @apply bg-[#222] text-white;
}

.tiptap .code-block button[role="combobox"]:hover{
  color: white;
}
.tiptap .code-block button[role="combobox"] {
  @apply bg-[#363636] border-[#595959];
}

.tiptap .pre-header button,
.tiptap .code-block button {
  @apply hover:bg-[#404040];
}

.tiptap .code-block *::-webkit-scrollbar-track {
  @apply !bg-transparent;
}

/* cmdk list scrollbar */
[cmdk-list] {
  scrollbar-width: thin; /* Firefox */
  scrollbar-color: #52525b transparent; /* thumb / track */
}

[cmdk-list]::-webkit-scrollbar {
  width: 6px;
  height: 6px; /* horizontal scrollbar, optional */
}

[cmdk-list]::-webkit-scrollbar-track {
  background: transparent;
}

[cmdk-list]::-webkit-scrollbar-thumb {
  background-color: #52525b; /* zinc-700 */
  border-radius: 9999px; /* fully rounded */
}

[cmdk-list]::-webkit-scrollbar-thumb:hover {
  background-color: #818cf8; /* hover accent */
}



.tiptap .code-block select {
  @apply absolute bg-white right-[0.5rem] left-[0.5rem];
  position: absolute;
  background-color: var(--white);
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="Black" d="M7 10l5 5 5-5z"/></svg>');
  right: 0.5rem;
  top: 0.5rem;
}

.tiptap li {
  margin-bottom: 8px;
}

.tiptap li p {
  margin-bottom: 0;
}

.tiptap ul[data-type="taskList"] {
  list-style: none;
  margin-left: 0;
  padding: 0;
}

.tiptap ul[data-type="taskList"] li[data-checked="true"] p {
  @apply text-muted-foreground line-through;
}

.tiptap
  ul[data-type="taskList"]
  li[data-checked="true"]
  input[type="checkbox"] {
  @apply bg-primary;
}

.tiptap
  ul[data-type="taskList"]
  li[data-checked="true"]
  input[type="checkbox"]::before {
  content: "";
  position: absolute;
  inset: 0;
  background-color: hsl(var(--primary-foreground));
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>')
    center / contain no-repeat;
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>')
    center / contain no-repeat;
}

.tiptap ul[data-type="taskList"] input[type="checkbox"] {
  @apply mt-1.5 overflow-hidden relative appearance-none w-4 h-4 border border-primary rounded-sm;
}

.tiptap ul[data-type="taskList"] li {
  @apply flex items-start;
}

.tiptap ul[data-type="taskList"] li p {
  @apply font-semibold;
}

.tiptap ul[data-type="taskList"] li > label {
  flex: 0 0 auto;
  margin-right: 0.5rem;
  user-select: none;
}

.tiptap ul[data-type="taskList"] li > div {
  flex: 1 1 auto;
}

.tiptap ul[data-type="taskList"] ul[data-type="taskList"] {
  margin: 0;
}

.tiptap h1 {
  font-size: 2em;
  @apply font-semibold mb-8 leading-snug;
}

.tiptap h2 {
  font-size: 1.6em;
  @apply font-semibold mt-8 mb-4 leading-snug;
}

.tiptap h3 {
  font-size: 1.35em;
  @apply font-semibold mt-6 mb-2 leading-snug;
}

.tiptap h4 {
  font-size: 1.1em;
  @apply font-semibold mt-4 mb-2;
}

.tiptap h5 {
  font-size: 1em;
  @apply font-semibold m-0;
}

.tiptap h6 {
  font-size: 0.9em;
  @apply font-semibold m-0;
}

.tiptap p {
  @apply mb-2 leading-[1.75] dark:text-muted-foreground;
}

.tiptap p:not(:first-child) {
  @apply mt-2;
}

.tiptap a {
  @apply dark:text-[#7ab7ff] dark:hover:text-[#5e83b3] text-[#2964aa] hover:text-[#749ac8] no-underline;
}

.tiptap ul {
  @apply list-disc;
}

.tiptap ol {
  @apply list-decimal;
}

.tiptap li::marker {
  @apply font-bold;
}

.tiptap ol,
.tiptap ul {
  @apply mb-4 pl-[26px];
}

.tiptap p + :where(ol, ul) {
  @apply mt-0;
}

.tiptap :is(h1, h2, h3, h4, h5, h6, p) code {
  @apply font-mono bg-black/10 dark:bg-accent/40 py-[2.4px] px-[4.8px] rounded whitespace-pre-wrap;
}

.tiptap pre {
  white-space: pre;
  overflow-x: auto;
  tab-size: 4;
  display: flex;
  @apply bg-input/30 p-4 bg-[#181818];
}

.tiptap .pre-header button {
  color: white;
}

.tiptap pre code {
  @apply whitespace-pre p-0 m-0 leading-relaxed;
  white-space: pre !important;
  font-size: 0.875em;
  display: block;
}

.tiptap blockquote {
  @apply border-l-4 my-4 py-2 pl-6 italic text-muted-foreground bg-accent/30;
}

.tiptap hr {
  @apply border my-12;
}

/* Table-specific styling */
.tiptap table {
  @apply w-full mb-6 border-collapse overflow-hidden;
  table-layout: auto;
  margin: 0;
}

.tiptap tr:not(:last-child) {
  @apply border-b;
}

.tiptap td,
.tiptap th {
  @apply p-2 whitespace-nowrap;
  position: relative;
}

.tiptap td > *,
.tiptap th > * {
  margin-bottom: 0;
}

.tiptap th {
  @apply bg-accent/70 font-semibold text-left;
}

.tiptap td {
  @apply bg-background;
}

.tiptap .selectedCell:after {
  background: var(--gray-2);
  content: "";
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  pointer-events: none;
  position: absolute;
  z-index: 2;
}

.tiptap .column-resize-handle {
  @apply bg-accent -bottom-[2px] -right-[2px] top-0 absolute w-1 z-10;
}

.tiptap .tableWrapper {
  margin: 1.5rem 0;
  overflow-x: auto;
}

/* âœ… Fixed resize cursor */
.tiptap.resize-cursor {
  cursor: col-resize;
}

.tiptap
  :is(p, h1, h2, h3, h4, h5, h6, ul, ol, blockquote).is-editor-empty::before,
.tiptap :is(p, h1, h2, h3, h4, h5, h6, ul, ol, blockquote).is-empty::before {
  @apply text-muted-foreground/40 float-left h-0 pointer-events-none;
  content: attr(data-placeholder);
}

.tippy-arrow::before {
  @apply hidden;
}
.tippy-content {
  @apply bg-popover text-popover-foreground border shadow-md rounded-lg p-1 max-h-[300px] overflow-y-auto;
  padding: 4px !important;
}
.tippy-content {
  width: 256px;
  background: hsl(var(--popover));
  color: hsl(var(--popover-foreground));
  border-radius: 12px;
  border: 1px solid hsl(var(--border));
  box-shadow: var(--shadow-md);
  padding: 4px;
  max-height: 300px;
  overflow-y: auto;
}
.tippy-content::-webkit-scrollbar {
  @apply w-1 h-1;
}

/* Mathematics extension styles */
.tiptap .tiptap-mathematics-render {
  padding: 0 0.25rem;
  border-radius: 0.25rem;
}

.tiptap .tiptap-mathematics-render--editable {
  cursor: pointer;
  transition: background 0.2s;
}

.tiptap .tiptap-mathematics-render--editable:hover {
  @apply bg-muted;
}

.tiptap .tiptap-mathematics-render[data-type="inline-math"] {
  display: inline-block;
}

.tiptap .tiptap-mathematics-render[data-type="block-math"] {
  @apply block my-4 p-4 text-center;
}

.tiptap .tiptap-mathematics-render.inline-math-error,
.tiptap .tiptap-mathematics-render.block-math-error {
  @apply bg-destructive/10 text-destructive border-destructive/50 p-2 rounded-sm;
}

button:disabled {
  pointer-events: none;
  opacity: 0.5;
}

/* -----------------------------
   Base Image Styling
----------------------------- */
.tiptap img,
.resize-wrapper img,
.image-wrapper img {
  display: block;
  height: auto;
  max-width: 100%;
  border-radius: 0.375rem; /* Tailwind rounded-md */
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
  touch-action: none;
}

/* Outline on selection */
.tiptap img.ProseMirror-selectednode,
.ProseMirror-selectednode img,
.image-wrapper img.ProseMirror-selectednode {
  outline: 4px solid #615fff;
}

/* -----------------------------
   Alignment
----------------------------- */
/* On inner wrapper */
.image-wrapper[data-align="left"] {
  margin-left: 0;
  margin-right: auto;
}

.image-wrapper[data-align="center"] {
  margin-left: auto;
  margin-right: auto;
}

.image-wrapper[data-align="right"] {
  margin-left: auto;
  margin-right: 0;
}

/* Legacy / fallback on img (optional) */
.tiptap img[data-align="left"] {
  margin-left: 0;
  margin-right: auto;
}

.tiptap img[data-align="center"] {
  margin-left: auto;
  margin-right: auto;
}

.tiptap img[data-align="right"] {
  margin-left: auto;
  margin-right: 0;
}

/* -----------------------------
   Node Image & Wrappers
----------------------------- */
.react-renderer.node-image,
.node-image {
  display: flex; /* Outer wrapper */
  width: 100%;
}

.image-wrapper {
  display: inline-flex; /* shrink to fit image */
  position: relative;
}

/* -----------------------------
   Resize Container & Wrapper
----------------------------- */
.resize-container,
.resize-wrapper {
  position: relative;
  max-width: 100%;
  margin: 1rem auto;
}

.resize-wrapper img {
  width: 100%;
  height: auto;
  display: block;
}

/* -----------------------------
   Resize Handles
----------------------------- */
.resize-handle {
  position: absolute;
  top: 50%;
  width: 8px;
  height: 40px;
  display: none;
  align-items: center;
  justify-content: center;
  cursor: ew-resize;
  border-radius: 50px;
  background-color: #615fff;
  transform: translateY(-50%);
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}

.node-image:hover .resize-handle {
  display: flex;
}

.image-wrapper.resizing .resize-handle {
  transform: translateY(-50%) scale(1.2);
  background-color: #4338ca;
}

.image-wrapper.resizing img {
  outline: 3px solid #615fff;
  outline-offset: 4px;
}

/* -----------------------------
   Bubble Menu Active State
----------------------------- */
.bubble-menu .is-active {
  @apply bg-primary/20;
}
